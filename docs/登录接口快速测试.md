# 用户登录接口快速测试

## 测试前准备

### 1. 确保项目已启动
访问 http://localhost:8080/doc.html 确认服务正常运行

### 2. 准备测试数据
使用之前注册的测试账号，或者使用以下SQL插入测试用户：

```sql
-- 查询是否存在测试用户
SELECT * FROM users WHERE account = '2024001';

-- 如果没有，可以先通过注册接口创建
-- POST /api/auth/register
```

## 快速测试命令

### 测试1: 使用cURL测试登录（Windows PowerShell）

```powershell
# 正常登录测试
curl.exe -X POST http://localhost:8080/api/auth/login `
  -H "Content-Type: application/json" `
  -d '{\"account\":\"2024001\",\"password\":\"123456\"}'
```

### 测试2: 使用cURL测试登录（Linux/Mac）

```bash
# 正常登录测试
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"account":"2024001","password":"123456"}'
```

### 测试3: 密码错误测试

```powershell
# Windows PowerShell
curl.exe -X POST http://localhost:8080/api/auth/login `
  -H "Content-Type: application/json" `
  -d '{\"account\":\"2024001\",\"password\":\"wrongpass\"}'
```

### 测试4: 账号不存在测试

```powershell
# Windows PowerShell
curl.exe -X POST http://localhost:8080/api/auth/login `
  -H "Content-Type: application/json" `
  -d '{\"account\":\"notexist\",\"password\":\"123456\"}'
```

## 使用Knife4j测试（推荐）

1. 打开浏览器访问: http://localhost:8080/doc.html
2. 在左侧导航栏找到"认证授权模块"
3. 点击"用户登录"接口
4. 点击右侧的"调试"标签
5. 输入测试参数：
   - account: 2024001
   - password: 123456
6. 点击"发送"按钮
7. 查看响应结果

## 预期结果

### 成功响应示例
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "nickname": "2024001",
      "avatar": null
    }
  }
}
```

### 失败响应示例（密码错误）
```json
{
  "code": 40003,
  "message": "账号或密码错误",
  "data": null
}
```

## 验证Token

登录成功后，可以使用返回的Token访问需要认证的接口（后续开发）：

```powershell
# Windows PowerShell
curl.exe -X GET http://localhost:8080/api/users/me `
  -H "Authorization: Bearer 你的Token"
```

## 注意事项

1. 如果提示"账号或密码错误"，请先通过注册接口创建测试账号
2. Token默认7天有效，过期后需要重新登录
3. 密码使用BCrypt加密，不可逆

## 故障排除

### 问题1: 连接被拒绝
**解决**: 确认服务是否启动，访问 http://localhost:8080/doc.html

### 问题2: 账号或密码错误
**解决**: 
- 先通过注册接口创建账号
- 或者检查数据库中是否存在该账号

### 问题3: 500错误
**解决**: 
- 查看控制台日志
- 检查数据库连接是否正常
- 检查Redis是否启动（如果配置了）
