# å­¦æ ¡å’Œå­¦é™¢æ¥å£å¼€å‘å®Œæˆè¯´æ˜

## ğŸ“¦ å·²åˆ›å»ºæ–‡ä»¶æ¸…å•

### 1. DTOå±‚
- **SchoolQueryDTO.java** - å­¦æ ¡åˆ—è¡¨æŸ¥è¯¢è¯·æ±‚å¯¹è±¡
  - åŒ…å«çœä»½ã€åŸå¸‚ç­›é€‰æ¡ä»¶ï¼ˆå¯é€‰ï¼‰
  
- **DepartmentQueryDTO.java** - å­¦é™¢åˆ—è¡¨æŸ¥è¯¢è¯·æ±‚å¯¹è±¡
  - åŒ…å«å­¦æ ¡IDç­›é€‰æ¡ä»¶ï¼ˆå¿…å¡«ï¼‰

### 2. VOå±‚
- **SchoolVO.java** - å­¦æ ¡ä¿¡æ¯å“åº”å¯¹è±¡
  - åŒ…å«å­¦æ ¡IDã€åç§°ã€ä»£ç ã€çœä»½ã€åŸå¸‚ç­‰ä¿¡æ¯
  
- **DepartmentVO.java** - å­¦é™¢ä¿¡æ¯å“åº”å¯¹è±¡
  - åŒ…å«å­¦é™¢IDã€å­¦æ ¡IDã€åç§°ã€ä»£ç ç­‰ä¿¡æ¯

### 3. Mapperå±‚
- **SchoolMapper.java** - å­¦æ ¡æ•°æ®è®¿é—®æ¥å£
- **DepartmentMapper.java** - å­¦é™¢æ•°æ®è®¿é—®æ¥å£

### 4. Serviceå±‚
- **SchoolService.java** - å­¦æ ¡æœåŠ¡æ¥å£
- **SchoolServiceImpl.java** - å­¦æ ¡æœåŠ¡å®ç°ç±»
  - âœ… æ”¯æŒçœä»½å’ŒåŸå¸‚ç­›é€‰
  - âœ… åªè¿”å›å¯ç”¨çŠ¶æ€çš„å­¦æ ¡ï¼ˆstatus=1ï¼‰
  - âœ… æŒ‰ sort_order æ’åº
  - âœ… ä½¿ç”¨Stream APIè½¬æ¢ä¸ºVOå¯¹è±¡
  
- **DepartmentService.java** - å­¦é™¢æœåŠ¡æ¥å£
- **DepartmentServiceImpl.java** - å­¦é™¢æœåŠ¡å®ç°ç±»
  - âœ… æ ¹æ®å­¦æ ¡IDæŸ¥è¯¢å­¦é™¢
  - âœ… åªè¿”å›å¯ç”¨çŠ¶æ€çš„å­¦é™¢ï¼ˆstatus=1ï¼‰
  - âœ… æŒ‰ sort_order æ’åº
  - âœ… ä½¿ç”¨Stream APIè½¬æ¢ä¸ºVOå¯¹è±¡

### 5. Controllerå±‚
- **SchoolController.java** - å­¦æ ¡æ§åˆ¶å™¨
  - æä¾› GET /api/schools æ¥å£
  - æ”¯æŒ province å’Œ city æŸ¥è¯¢å‚æ•°
  
- **DepartmentController.java** - å­¦é™¢æ§åˆ¶å™¨
  - æä¾› GET /api/departments æ¥å£
  - å¿…å¡« schoolId æŸ¥è¯¢å‚æ•°

---

## ğŸ” ä»£ç ç‰¹ç‚¹

### 1. å®Œæ•´çš„æ³¨é‡Š
âœ… æ‰€æœ‰ç±»ã€æ–¹æ³•ã€å­—æ®µéƒ½æœ‰è¯¦ç»†çš„ JavaDoc æ³¨é‡Š  
âœ… ä¸šåŠ¡é€»è¾‘å…³é”®ç‚¹éƒ½æœ‰è¡Œå†…æ³¨é‡Šè¯´æ˜  
âœ… æ³¨é‡Šç¬¦åˆ Java è§„èŒƒ

### 2. åˆ†å±‚æ¶æ„æ¸…æ™°
```
Controller -> Service -> Mapper -> Database
    â†“           â†“          â†“
  Query       VO       Entity
```

### 3. æŸ¥è¯¢é€»è¾‘å®Œæ•´

#### å­¦æ ¡åˆ—è¡¨æŸ¥è¯¢é€»è¾‘
```java
1. æ„å»ºæŸ¥è¯¢æ¡ä»¶ï¼šstatus=1ï¼ˆåªæŸ¥å¯ç”¨çš„å­¦æ ¡ï¼‰
2. å¦‚æœä¼ å…¥çœä»½ï¼Œæ·»åŠ çœä»½ç­›é€‰
3. å¦‚æœä¼ å…¥åŸå¸‚ï¼Œæ·»åŠ åŸå¸‚ç­›é€‰
4. æŒ‰ sort_order æ’åº
5. è½¬æ¢ä¸ºVOå¯¹è±¡è¿”å›
```

#### å­¦é™¢åˆ—è¡¨æŸ¥è¯¢é€»è¾‘
```java
1. æ„å»ºæŸ¥è¯¢æ¡ä»¶ï¼šschool_id = ? AND status = 1
2. æŒ‰ sort_order æ’åº
3. è½¬æ¢ä¸ºVOå¯¹è±¡è¿”å›
```

### 4. å‚æ•°æ ¡éªŒ
- âœ… å­¦é™¢æ¥å£çš„ schoolId ä½¿ç”¨ @NotNull æ ¡éªŒ
- âœ… Controller å±‚ä½¿ç”¨ @Validated å¯ç”¨æ ¡éªŒ

### 5. ç¬¦åˆ API æ–‡æ¡£è§„èŒƒ
- âœ… æ¥å£è·¯å¾„ç¬¦åˆè§„èŒƒ
- âœ… è¯·æ±‚å‚æ•°ä¸ API.md ä¸€è‡´
- âœ… å“åº”æ ¼å¼ä¸ API.md ä¸€è‡´
- âœ… æŸ¥è¯¢é€»è¾‘ç¬¦åˆè§„èŒƒ

---

## ğŸš€ æ¥å£è¯´æ˜

### 1. è·å–å­¦æ ¡åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/schools`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| province | String | å¦ | çœä»½ç­›é€‰ |
| city | String | å¦ | åŸå¸‚ç­›é€‰ |

**è¯·æ±‚ç¤ºä¾‹**:
```bash
# è·å–æ‰€æœ‰å­¦æ ¡
GET http://localhost:8080/api/schools

# æŒ‰çœä»½ç­›é€‰
GET http://localhost:8080/api/schools?province=åŒ—äº¬

# æŒ‰åŸå¸‚ç­›é€‰
GET http://localhost:8080/api/schools?city=åŒ—äº¬å¸‚

# åŒæ—¶æŒ‰çœä»½å’ŒåŸå¸‚ç­›é€‰
GET http://localhost:8080/api/schools?province=åŒ—äº¬&city=åŒ—äº¬å¸‚
```

**æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "æ¸…åå¤§å­¦",
      "code": "THU",
      "province": "åŒ—äº¬",
      "city": "åŒ—äº¬å¸‚"
    },
    {
      "id": 2,
      "name": "åŒ—äº¬å¤§å­¦",
      "code": "PKU",
      "province": "åŒ—äº¬",
      "city": "åŒ—äº¬å¸‚"
    }
  ],
  "timestamp": 1701234567890
}
```

---

### 2. è·å–å­¦é™¢åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /api/departments`

**æŸ¥è¯¢å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| schoolId | Long | æ˜¯ | å­¦æ ¡ID |

**è¯·æ±‚ç¤ºä¾‹**:
```bash
# è·å–æ¸…åå¤§å­¦çš„å­¦é™¢åˆ—è¡¨
GET http://localhost:8080/api/departments?schoolId=1

# è·å–åŒ—äº¬å¤§å­¦çš„å­¦é™¢åˆ—è¡¨
GET http://localhost:8080/api/departments?schoolId=2
```

**æˆåŠŸå“åº”**:
```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": [
    {
      "id": 1,
      "schoolId": 1,
      "name": "è®¡ç®—æœºç³»",
      "code": "CS"
    },
    {
      "id": 2,
      "schoolId": 1,
      "name": "ç»ç®¡å­¦é™¢",
      "code": "SEM"
    },
    {
      "id": 3,
      "schoolId": 1,
      "name": "å»ºç­‘å­¦é™¢",
      "code": "ARCH"
    }
  ],
  "timestamp": 1701234567890
}
```

**å‚æ•°ç¼ºå¤±å“åº”**:
```json
{
  "code": 40004,
  "message": "å­¦æ ¡IDä¸èƒ½ä¸ºç©º",
  "data": null,
  "timestamp": 1701234567890
}
```

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•ç”¨ä¾‹1ï¼šè·å–æ‰€æœ‰å­¦æ ¡

**è¯·æ±‚**:
```bash
GET http://localhost:8080/api/schools
```

**é¢„æœŸç»“æœ**:
- è¿”å›5æ‰€å­¦æ ¡ï¼ˆæ¸…åã€åŒ—å¤§ã€å¤æ—¦ã€äº¤å¤§ã€æµ™å¤§ï¼‰
- æŒ‰ sort_order æ’åº

---

### æµ‹è¯•ç”¨ä¾‹2ï¼šæŒ‰çœä»½ç­›é€‰å­¦æ ¡

**è¯·æ±‚**:
```bash
GET http://localhost:8080/api/schools?province=åŒ—äº¬
```

**é¢„æœŸç»“æœ**:
- è¿”å›2æ‰€å­¦æ ¡ï¼ˆæ¸…åã€åŒ—å¤§ï¼‰
- æŒ‰ sort_order æ’åº

---

### æµ‹è¯•ç”¨ä¾‹3ï¼šæŒ‰åŸå¸‚ç­›é€‰å­¦æ ¡

**è¯·æ±‚**:
```bash
GET http://localhost:8080/api/schools?city=ä¸Šæµ·å¸‚
```

**é¢„æœŸç»“æœ**:
- è¿”å›2æ‰€å­¦æ ¡ï¼ˆå¤æ—¦ã€äº¤å¤§ï¼‰
- æŒ‰ sort_order æ’åº

---

### æµ‹è¯•ç”¨ä¾‹4ï¼šè·å–æ¸…åå¤§å­¦çš„å­¦é™¢åˆ—è¡¨

**è¯·æ±‚**:
```bash
GET http://localhost:8080/api/departments?schoolId=1
```

**é¢„æœŸç»“æœ**:
- è¿”å›5ä¸ªå­¦é™¢ï¼ˆè®¡ç®—æœºç³»ã€ç»ç®¡å­¦é™¢ã€å»ºç­‘å­¦é™¢ã€ç”µå­å·¥ç¨‹ç³»ã€è‡ªåŠ¨åŒ–ç³»ï¼‰
- æŒ‰ sort_order æ’åº

---

### æµ‹è¯•ç”¨ä¾‹5ï¼šè·å–åŒ—äº¬å¤§å­¦çš„å­¦é™¢åˆ—è¡¨

**è¯·æ±‚**:
```bash
GET http://localhost:8080/api/departments?schoolId=2
```

**é¢„æœŸç»“æœ**:
- è¿”å›4ä¸ªå­¦é™¢ï¼ˆä¿¡ç§‘ã€å…‰åã€å…ƒåŸ¹ã€æ•°å­¦ï¼‰
- æŒ‰ sort_order æ’åº

---

### æµ‹è¯•ç”¨ä¾‹6ï¼šå­¦é™¢æ¥å£ç¼ºå°‘schoolIdå‚æ•°

**è¯·æ±‚**:
```bash
GET http://localhost:8080/api/departments
```

**é¢„æœŸç»“æœ**:
- è¿”å›é”™è¯¯ç  40004
- é”™è¯¯ä¿¡æ¯ï¼š"å­¦æ ¡IDä¸èƒ½ä¸ºç©º"

---

## ğŸ“Š æ•°æ®åº“æµ‹è¯•æ•°æ®

### å­¦æ ¡æ•°æ®ï¼ˆ5æ‰€ï¼‰

| ID | åç§° | ä»£ç  | çœä»½ | åŸå¸‚ |
|----|------|------|------|------|
| 1 | æ¸…åå¤§å­¦ | THU | åŒ—äº¬ | åŒ—äº¬å¸‚ |
| 2 | åŒ—äº¬å¤§å­¦ | PKU | åŒ—äº¬ | åŒ—äº¬å¸‚ |
| 3 | å¤æ—¦å¤§å­¦ | FDU | ä¸Šæµ· | ä¸Šæµ·å¸‚ |
| 4 | ä¸Šæµ·äº¤é€šå¤§å­¦ | SJTU | ä¸Šæµ· | ä¸Šæµ·å¸‚ |
| 5 | æµ™æ±Ÿå¤§å­¦ | ZJU | æµ™æ±Ÿ | æ­å·å¸‚ |

### å­¦é™¢æ•°æ®ï¼ˆ20+ä¸ªï¼‰

#### æ¸…åå¤§å­¦ï¼ˆ5ä¸ªå­¦é™¢ï¼‰
| ID | åç§° | ä»£ç  |
|----|------|------|
| 1 | è®¡ç®—æœºç³» | CS |
| 2 | ç»ç®¡å­¦é™¢ | SEM |
| 3 | å»ºç­‘å­¦é™¢ | ARCH |
| 4 | ç”µå­å·¥ç¨‹ç³» | EE |
| 5 | è‡ªåŠ¨åŒ–ç³» | AUTO |

#### åŒ—äº¬å¤§å­¦ï¼ˆ4ä¸ªå­¦é™¢ï¼‰
| ID | åç§° | ä»£ç  |
|----|------|------|
| 6 | ä¿¡æ¯ç§‘å­¦æŠ€æœ¯å­¦é™¢ | EECS |
| 7 | å…‰åç®¡ç†å­¦é™¢ | GSM |
| 8 | å…ƒåŸ¹å­¦é™¢ | YP |
| 9 | æ•°å­¦ç§‘å­¦å­¦é™¢ | SMS |

å…¶ä»–å­¦æ ¡å­¦é™¢è¯¦è§æ•°æ®åº“...

---

## ğŸ”§ ä½¿ç”¨åœºæ™¯

### å‰ç«¯æ³¨å†Œæµç¨‹

```javascript
// 1. é¡µé¢åŠ è½½æ—¶è·å–å­¦æ ¡åˆ—è¡¨
const schools = await fetch('/api/schools').then(r => r.json());

// 2. ç”¨æˆ·é€‰æ‹©å­¦æ ¡åï¼Œè·å–å¯¹åº”çš„å­¦é™¢åˆ—è¡¨
const schoolId = selectedSchool.id;
const departments = await fetch(`/api/departments?schoolId=${schoolId}`).then(r => r.json());

// 3. ç”¨æˆ·é€‰æ‹©å­¦é™¢åï¼Œç»§ç»­å¡«å†™å…¶ä»–ä¿¡æ¯
```

---

## ğŸ“ ä»£ç å®¡æŸ¥è¦ç‚¹

### 1. Service å±‚ä½¿ç”¨ Hutool å·¥å…·ç±»

```java
// ä½¿ç”¨ Hutool çš„å­—ç¬¦ä¸²å·¥å…·åˆ¤æ–­æ˜¯å¦ä¸ºç©º
if (StrUtil.isNotBlank(province)) {
    queryWrapper.eq(School::getProvince, province);
}
```

### 2. ä½¿ç”¨ Lambda è¡¨è¾¾å¼æ„å»ºæŸ¥è¯¢æ¡ä»¶

```java
LambdaQueryWrapper<School> queryWrapper = new LambdaQueryWrapper<>();
queryWrapper.eq(School::getStatus, 1)
           .orderByAsc(School::getSortOrder);
```

### 3. ä½¿ç”¨ Stream API è½¬æ¢æ•°æ®

```java
List<SchoolVO> schoolVOList = schoolList.stream()
        .map(this::convertToVO)
        .collect(Collectors.toList());
```

### 4. ç§æœ‰æ–¹æ³•æå–è½¬æ¢é€»è¾‘

```java
private SchoolVO convertToVO(School school) {
    return SchoolVO.builder()
            .id(school.getId())
            .name(school.getName())
            // ...
            .build();
}
```

### 5. å‚æ•°æ ¡éªŒ

```java
// Controller å±‚å¯ç”¨æ ¡éªŒ
@Validated
public class DepartmentController {
    
    // å‚æ•°æ·»åŠ æ ¡éªŒæ³¨è§£
    @RequestParam @NotNull(message = "å­¦æ ¡IDä¸èƒ½ä¸ºç©º") Long schoolId
}
```

---

## âœ… æµ‹è¯•æ¸…å•

- [ ] å¯åŠ¨é¡¹ç›®æ— æŠ¥é”™
- [ ] è®¿é—® Swagger æ–‡æ¡£æˆåŠŸ
- [ ] æµ‹è¯•è·å–æ‰€æœ‰å­¦æ ¡
- [ ] æµ‹è¯•æŒ‰çœä»½ç­›é€‰å­¦æ ¡
- [ ] æµ‹è¯•æŒ‰åŸå¸‚ç­›é€‰å­¦æ ¡
- [ ] æµ‹è¯•è·å–æ¸…åå¤§å­¦å­¦é™¢åˆ—è¡¨
- [ ] æµ‹è¯•è·å–åŒ—äº¬å¤§å­¦å­¦é™¢åˆ—è¡¨
- [ ] æµ‹è¯•å­¦é™¢æ¥å£ç¼ºå°‘ schoolId å‚æ•°
- [ ] æ£€æŸ¥è¿”å›æ•°æ®æ˜¯å¦æŒ‰ sort_order æ’åº
- [ ] æ£€æŸ¥æ˜¯å¦åªè¿”å› status=1 çš„æ•°æ®

---

## ğŸ¯ ä¸æ³¨å†Œæ¥å£çš„é…åˆä½¿ç”¨

è¿™ä¸¤ä¸ªæ¥å£ä¸»è¦ç”¨äºæ³¨å†Œæµç¨‹ï¼š

```
1. å‰ç«¯æ‰“å¼€æ³¨å†Œé¡µé¢
   â†“
2. è°ƒç”¨ GET /api/schools è·å–å­¦æ ¡åˆ—è¡¨
   â†“
3. ç”¨æˆ·é€‰æ‹©å­¦æ ¡
   â†“
4. è°ƒç”¨ GET /api/departments?schoolId=1 è·å–å­¦é™¢åˆ—è¡¨
   â†“
5. ç”¨æˆ·é€‰æ‹©å­¦é™¢å¹¶å¡«å†™å­¦å·
   â†“
6. è°ƒç”¨ POST /api/auth/register æäº¤æ³¨å†Œ
```

---

## ğŸ’¡ ä¼˜åŒ–å»ºè®®

### 1. ç¼“å­˜ä¼˜åŒ–
å­¦æ ¡å’Œå­¦é™¢æ•°æ®å˜åŒ–ä¸é¢‘ç¹ï¼Œå»ºè®®ï¼š
- å‰ç«¯ç¼“å­˜å­¦æ ¡åˆ—è¡¨ï¼ˆlocalStorageï¼‰
- åç«¯æ·»åŠ  Redis ç¼“å­˜ï¼ˆå‡å°‘æ•°æ®åº“æŸ¥è¯¢ï¼‰

### 2. æ¥å£æ€§èƒ½
- å½“å‰å®ç°å·²ç»æŒ‰ sort_order æ’åº
- åªæŸ¥è¯¢å¯ç”¨çŠ¶æ€çš„æ•°æ®
- ä½¿ç”¨ Stream API é«˜æ•ˆè½¬æ¢

### 3. æ‰©å±•æ€§
- å¦‚éœ€æ”¯æŒåˆ†é¡µï¼Œå¯ä»¥æ”¹é€ ä¸ºåˆ†é¡µæ¥å£
- å¦‚éœ€æ”¯æŒæ›´å¤šç­›é€‰æ¡ä»¶ï¼Œå¯ä»¥æ‰©å±• DTO

---

## ğŸ“š ç›¸å…³æ¥å£

å·²å®Œæˆçš„æ¥å£ï¼š
1. âœ… POST /api/auth/register - ç”¨æˆ·æ³¨å†Œ
2. âœ… GET /api/schools - è·å–å­¦æ ¡åˆ—è¡¨
3. âœ… GET /api/departments - è·å–å­¦é™¢åˆ—è¡¨

å¾…å¼€å‘çš„æ¥å£ï¼š
- [ ] GET /api/students/validate - éªŒè¯å­¦å·
- [ ] POST /api/auth/login - ç”¨æˆ·ç™»å½•
- [ ] GET /api/auth/current - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

---

**å¼€å‘å®Œæˆæ—¶é—´**: 2025-12-01  
**å¼€å‘è€…**: UniSport Team  
**ä»£ç çŠ¶æ€**: âœ… å·²æ£€æŸ¥ï¼Œæ— ç¼–è¯‘é”™è¯¯
