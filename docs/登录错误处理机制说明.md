# ç™»å½•æ¥å£é”™è¯¯å¤„ç†æœºåˆ¶è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†UniSportåç«¯ç™»å½•æ¥å£çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œä»¥åŠå‰ç«¯å¦‚ä½•æ¥æ”¶å’Œå¤„ç†è¿™äº›é”™è¯¯ä¿¡æ¯ã€‚

## ğŸ¯ é”™è¯¯å¤„ç†æ¶æ„

### 1. åˆ†å±‚é”™è¯¯å¤„ç†

```mermaid
graph TB
    A[å‰ç«¯å‘èµ·ç™»å½•è¯·æ±‚] --> B[Controllerå±‚æ¥æ”¶]
    B --> C[å‚æ•°æ ¡éªŒ @Valid]
    C --> D{å‚æ•°æ˜¯å¦åˆæ³•?}
    D -->|ä¸åˆæ³•| E[MethodArgumentNotValidException]
    D -->|åˆæ³•| F[Serviceå±‚ä¸šåŠ¡å¤„ç†]
    F --> G{ä¸šåŠ¡é€»è¾‘æ£€æŸ¥}
    G -->|è´¦å·ä¸å­˜åœ¨| H[BusinessException 40003]
    G -->|å¯†ç é”™è¯¯| I[BusinessException 40003]
    G -->|è´¦å·ç¦ç”¨| J[BusinessException 40004]
    G -->|ç³»ç»Ÿå¼‚å¸¸| K[BusinessException 50000]
    G -->|éªŒè¯é€šè¿‡| L[è¿”å›Tokenå’Œç”¨æˆ·ä¿¡æ¯]
    E --> M[GlobalExceptionHandleræ•è·]
    H --> M
    I --> M
    J --> M
    K --> M
    M --> N[ç»Ÿä¸€Resultæ ¼å¼è¿”å›]
    N --> O[å‰ç«¯æ¥æ”¶é”™è¯¯ä¿¡æ¯]
```

### 2. æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | ä½œç”¨ | ä½ç½® |
|------|------|------|
| **LoginDTO** | è¯·æ±‚å‚æ•°æ ¡éªŒ | `com.unisport.dto.LoginDTO` |
| **AuthService** | ä¸šåŠ¡é€»è¾‘éªŒè¯ | `com.unisport.service.impl.AuthServiceImpl` |
| **BusinessException** | ä¸šåŠ¡å¼‚å¸¸ç±» | `com.unisport.common.BusinessException` |
| **GlobalExceptionHandler** | å…¨å±€å¼‚å¸¸å¤„ç†å™¨ | `com.unisport.config.GlobalExceptionHandler` |
| **Result** | ç»Ÿä¸€å“åº”æ ¼å¼ | `com.unisport.common.Result` |

## ğŸš¨ é”™è¯¯ç è§„èŒƒ

### å®Œæ•´é”™è¯¯ç åˆ—è¡¨

| é”™è¯¯ç  | é”™è¯¯åœºæ™¯ | é”™è¯¯æ¶ˆæ¯ | HTTPçŠ¶æ€ |
|--------|----------|----------|----------|
| **400** | å‚æ•°æ ¡éªŒå¤±è´¥ | è´¦å·ä¸èƒ½ä¸ºç©º / å¯†ç ä¸èƒ½ä¸ºç©º | 200 |
| **40003** | è´¦å·ä¸å­˜åœ¨ | è´¦å·æˆ–å¯†ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥åé‡è¯• | 200 |
| **40003** | å¯†ç é”™è¯¯ | è´¦å·æˆ–å¯†ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥åé‡è¯• | 200 |
| **40004** | è´¦å·è¢«ç¦ç”¨ | æ‚¨çš„è´¦å·å·²è¢«ç¦ç”¨ï¼Œå¦‚æœ‰ç–‘é—®è¯·è”ç³»ç®¡ç†å‘˜ | 200 |
| **50000** | ç³»ç»Ÿå¼‚å¸¸ | ç™»å½•å¤±è´¥ï¼Œç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯• | 200 |

> **æ³¨æ„**ï¼šæ‰€æœ‰ä¸šåŠ¡é”™è¯¯éƒ½è¿”å›HTTP 200çŠ¶æ€ç ï¼Œé€šè¿‡å“åº”ä½“ä¸­çš„`code`å­—æ®µåŒºåˆ†é”™è¯¯ç±»å‹ã€‚

### é”™è¯¯ç è®¾è®¡åŸåˆ™

1. **å®‰å…¨æ€§ä¼˜å…ˆ**ï¼šè´¦å·ä¸å­˜åœ¨å’Œå¯†ç é”™è¯¯ä½¿ç”¨ç›¸åŒçš„é”™è¯¯ç å’Œæç¤ºï¼Œé˜²æ­¢ä¿¡æ¯æ³„éœ²
2. **ç”¨æˆ·å‹å¥½**ï¼šé”™è¯¯æç¤ºæ¸…æ™°æ˜äº†ï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•æ“ä½œ
3. **å¯è¿½æº¯æ€§**ï¼šåç«¯æ—¥å¿—è®°å½•è¯¦ç»†ä¿¡æ¯ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥

## ğŸ“¦ å“åº”æ ¼å¼

### 1. æˆåŠŸå“åº”

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "nickname": "å¼ ä¸‰",
      "avatar": "https://example.com/avatar.jpg"
    }
  },
  "timestamp": 1701667200000
}
```

### 2. å¤±è´¥å“åº”ç¤ºä¾‹

#### ç¤ºä¾‹1ï¼šè´¦å·æˆ–å¯†ç é”™è¯¯

**è¯·æ±‚**ï¼š
```json
POST /api/auth/login
{
  "account": "2024001",
  "password": "wrongpassword"
}
```

**å“åº”**ï¼š
```json
{
  "code": 40003,
  "message": "è´¦å·æˆ–å¯†ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥åé‡è¯•",
  "data": null,
  "timestamp": 1701667200000
}
```

#### ç¤ºä¾‹2ï¼šè´¦å·è¢«ç¦ç”¨

**å“åº”**ï¼š
```json
{
  "code": 40004,
  "message": "æ‚¨çš„è´¦å·å·²è¢«ç¦ç”¨ï¼Œå¦‚æœ‰ç–‘é—®è¯·è”ç³»ç®¡ç†å‘˜",
  "data": null,
  "timestamp": 1701667200000
}
```

#### ç¤ºä¾‹3ï¼šå‚æ•°æ ¡éªŒå¤±è´¥

**è¯·æ±‚**ï¼š
```json
POST /api/auth/login
{
  "account": "",
  "password": "123456"
}
```

**å“åº”**ï¼š
```json
{
  "code": 400,
  "message": "è´¦å·ä¸èƒ½ä¸ºç©º",
  "data": null,
  "timestamp": 1701667200000
}
```

#### ç¤ºä¾‹4ï¼šç³»ç»Ÿå¼‚å¸¸

**å“åº”**ï¼š
```json
{
  "code": 50000,
  "message": "ç™»å½•å¤±è´¥ï¼Œç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•",
  "data": null,
  "timestamp": 1701667200000
}
```

## ğŸ’» å‰ç«¯å¯¹æ¥æŒ‡å—

### 1. åŸºç¡€å¯¹æ¥æ–¹å¼

#### JavaScript/Axiosç¤ºä¾‹

```javascript
// ç™»å½•è¯·æ±‚
async function login(account, password) {
  try {
    const response = await axios.post('/api/auth/login', {
      account: account,
      password: password
    });
    
    // åˆ¤æ–­æ˜¯å¦æˆåŠŸï¼ˆcode === 200ï¼‰
    if (response.data.code === 200) {
      // ç™»å½•æˆåŠŸ
      const { token, user } = response.data.data;
      
      // å­˜å‚¨tokenåˆ°localStorage
      localStorage.setItem('token', token);
      localStorage.setItem('user', JSON.stringify(user));
      
      // è·³è½¬åˆ°ä¸»é¡µ
      window.location.href = '/home';
      
      // æˆ–è¿”å›æˆåŠŸ
      return { success: true, data: response.data.data };
    } else {
      // ç™»å½•å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
      showError(response.data.message);
      return { success: false, message: response.data.message };
    }
  } catch (error) {
    // ç½‘ç»œé”™è¯¯æˆ–å…¶ä»–å¼‚å¸¸
    console.error('ç™»å½•è¯·æ±‚å¤±è´¥:', error);
    showError('ç½‘ç»œå¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
    return { success: false, message: 'ç½‘ç»œå¼‚å¸¸' };
  }
}

// é”™è¯¯æç¤ºå‡½æ•°
function showError(message) {
  // ä½¿ç”¨UIåº“æ˜¾ç¤ºé”™è¯¯æç¤º
  // ä¾‹å¦‚ï¼šElement UI
  ElementUI.Message.error(message);
  
  // æˆ–è€…ï¼šAnt Design Vue
  // this.$message.error(message);
  
  // æˆ–è€…ï¼šåŸç”Ÿalert
  // alert(message);
}
```

### 2. Vue 3 + TypeScript å®Œæ•´ç¤ºä¾‹

```typescript
// types.ts - ç±»å‹å®šä¹‰
export interface LoginRequest {
  account: string;
  password: string;
}

export interface LoginResponse {
  code: number;
  message: string;
  data: {
    token: string;
    user: {
      id: number;
      nickname: string;
      avatar: string | null;
    };
  } | null;
  timestamp: number;
}

// api/auth.ts - APIå°è£…
import axios from 'axios';
import type { LoginRequest, LoginResponse } from '@/types';

export async function loginAPI(data: LoginRequest): Promise<LoginResponse> {
  const response = await axios.post<LoginResponse>('/api/auth/login', data);
  return response.data;
}

// views/Login.vue - ç™»å½•é¡µé¢
<template>
  <div class="login-container">
    <el-form :model="loginForm" :rules="rules" ref="loginFormRef">
      <el-form-item prop="account">
        <el-input 
          v-model="loginForm.account" 
          placeholder="è¯·è¾“å…¥è´¦å·"
          clearable
        />
      </el-form-item>
      
      <el-form-item prop="password">
        <el-input 
          v-model="loginForm.password" 
          type="password" 
          placeholder="è¯·è¾“å…¥å¯†ç "
          show-password
          @keyup.enter="handleLogin"
        />
      </el-form-item>
      
      <el-form-item>
        <el-button 
          type="primary" 
          :loading="loading" 
          @click="handleLogin"
          style="width: 100%"
        >
          ç™»å½•
        </el-button>
      </el-form-item>
    </el-form>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue';
import { useRouter } from 'vue-router';
import { ElMessage } from 'element-plus';
import type { FormInstance, FormRules } from 'element-plus';
import { loginAPI } from '@/api/auth';

const router = useRouter();
const loading = ref(false);
const loginFormRef = ref<FormInstance>();

// è¡¨å•æ•°æ®
const loginForm = reactive({
  account: '',
  password: ''
});

// è¡¨å•éªŒè¯è§„åˆ™
const rules: FormRules = {
  account: [
    { required: true, message: 'è¯·è¾“å…¥è´¦å·', trigger: 'blur' }
  ],
  password: [
    { required: true, message: 'è¯·è¾“å…¥å¯†ç ', trigger: 'blur' }
  ]
};

// å¤„ç†ç™»å½•
const handleLogin = async () => {
  if (!loginFormRef.value) return;
  
  // éªŒè¯è¡¨å•
  await loginFormRef.value.validate(async (valid) => {
    if (!valid) return;
    
    loading.value = true;
    
    try {
      const response = await loginAPI(loginForm);
      
      // åˆ¤æ–­ç™»å½•æ˜¯å¦æˆåŠŸ
      if (response.code === 200 && response.data) {
        // å­˜å‚¨tokenå’Œç”¨æˆ·ä¿¡æ¯
        localStorage.setItem('token', response.data.token);
        localStorage.setItem('user', JSON.stringify(response.data.user));
        
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        ElMessage.success('ç™»å½•æˆåŠŸ');
        
        // è·³è½¬åˆ°é¦–é¡µ
        router.push('/home');
      } else {
        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        handleLoginError(response.code, response.message);
      }
    } catch (error) {
      console.error('ç™»å½•å¤±è´¥:', error);
      ElMessage.error('ç½‘ç»œå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•');
    } finally {
      loading.value = false;
    }
  });
};

// å¤„ç†ç™»å½•é”™è¯¯
const handleLoginError = (code: number, message: string) => {
  switch (code) {
    case 40003:
      // è´¦å·æˆ–å¯†ç é”™è¯¯
      ElMessage.error(message);
      // æ¸…ç©ºå¯†ç è¾“å…¥æ¡†
      loginForm.password = '';
      break;
      
    case 40004:
      // è´¦å·è¢«ç¦ç”¨
      ElMessage.error({
        message: message,
        duration: 5000
      });
      break;
      
    case 50000:
      // ç³»ç»Ÿå¼‚å¸¸
      ElMessage.error({
        message: message,
        duration: 3000
      });
      break;
      
    default:
      ElMessage.error(message || 'ç™»å½•å¤±è´¥');
  }
};
</script>
```

### 3. React + TypeScript ç¤ºä¾‹

```typescript
// types/auth.ts
export interface LoginRequest {
  account: string;
  password: string;
}

export interface LoginResponse {
  code: number;
  message: string;
  data: {
    token: string;
    user: {
      id: number;
      nickname: string;
      avatar: string | null;
    };
  } | null;
  timestamp: number;
}

// api/auth.ts
import axios from 'axios';
import type { LoginRequest, LoginResponse } from '@/types/auth';

export const loginAPI = async (data: LoginRequest): Promise<LoginResponse> => {
  const response = await axios.post<LoginResponse>('/api/auth/login', data);
  return response.data;
};

// components/Login.tsx
import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { Form, Input, Button, message } from 'antd';
import { loginAPI } from '@/api/auth';
import type { LoginRequest } from '@/types/auth';

const Login: React.FC = () => {
  const navigate = useNavigate();
  const [loading, setLoading] = useState(false);
  const [form] = Form.useForm();

  const handleLogin = async (values: LoginRequest) => {
    setLoading(true);
    
    try {
      const response = await loginAPI(values);
      
      if (response.code === 200 && response.data) {
        // å­˜å‚¨tokenå’Œç”¨æˆ·ä¿¡æ¯
        localStorage.setItem('token', response.data.token);
        localStorage.setItem('user', JSON.stringify(response.data.user));
        
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        message.success('ç™»å½•æˆåŠŸ');
        
        // è·³è½¬åˆ°é¦–é¡µ
        navigate('/home');
      } else {
        // å¤„ç†é”™è¯¯
        handleLoginError(response.code, response.message);
      }
    } catch (error) {
      console.error('ç™»å½•å¤±è´¥:', error);
      message.error('ç½‘ç»œå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•');
    } finally {
      setLoading(false);
    }
  };

  const handleLoginError = (code: number, msg: string) => {
    switch (code) {
      case 40003:
        message.error(msg);
        form.setFieldValue('password', '');
        break;
      case 40004:
        message.error({
          content: msg,
          duration: 5
        });
        break;
      case 50000:
        message.error(msg);
        break;
      default:
        message.error(msg || 'ç™»å½•å¤±è´¥');
    }
  };

  return (
    <div className="login-container">
      <Form
        form={form}
        onFinish={handleLogin}
        autoComplete="off"
      >
        <Form.Item
          name="account"
          rules={[{ required: true, message: 'è¯·è¾“å…¥è´¦å·' }]}
        >
          <Input placeholder="è¯·è¾“å…¥è´¦å·" />
        </Form.Item>

        <Form.Item
          name="password"
          rules={[{ required: true, message: 'è¯·è¾“å…¥å¯†ç ' }]}
        >
          <Input.Password placeholder="è¯·è¾“å…¥å¯†ç " />
        </Form.Item>

        <Form.Item>
          <Button type="primary" htmlType="submit" loading={loading} block>
            ç™»å½•
          </Button>
        </Form.Item>
      </Form>
    </div>
  );
};

export default Login;
```

### 4. å°ç¨‹åºç¤ºä¾‹ï¼ˆuni-appï¼‰

```javascript
// api/auth.js
export function login(data) {
  return uni.request({
    url: '/api/auth/login',
    method: 'POST',
    data: data
  });
}

// pages/login/login.vue
<template>
  <view class="login-container">
    <view class="form">
      <input 
        v-model="account" 
        placeholder="è¯·è¾“å…¥è´¦å·" 
        class="input"
      />
      <input 
        v-model="password" 
        type="password" 
        placeholder="è¯·è¾“å…¥å¯†ç " 
        class="input"
      />
      <button 
        @click="handleLogin" 
        :loading="loading"
        type="primary"
      >
        ç™»å½•
      </button>
    </view>
  </view>
</template>

<script>
import { login } from '@/api/auth';

export default {
  data() {
    return {
      account: '',
      password: '',
      loading: false
    };
  },
  methods: {
    async handleLogin() {
      // å‚æ•°æ ¡éªŒ
      if (!this.account) {
        uni.showToast({
          title: 'è¯·è¾“å…¥è´¦å·',
          icon: 'none'
        });
        return;
      }
      
      if (!this.password) {
        uni.showToast({
          title: 'è¯·è¾“å…¥å¯†ç ',
          icon: 'none'
        });
        return;
      }
      
      this.loading = true;
      
      try {
        const [error, response] = await login({
          account: this.account,
          password: this.password
        });
        
        if (error) {
          uni.showToast({
            title: 'ç½‘ç»œå¼‚å¸¸',
            icon: 'none'
          });
          return;
        }
        
        const { code, message, data } = response.data;
        
        if (code === 200 && data) {
          // å­˜å‚¨token
          uni.setStorageSync('token', data.token);
          uni.setStorageSync('user', data.user);
          
          // æ˜¾ç¤ºæˆåŠŸ
          uni.showToast({
            title: 'ç™»å½•æˆåŠŸ',
            icon: 'success'
          });
          
          // è·³è½¬
          setTimeout(() => {
            uni.switchTab({
              url: '/pages/home/home'
            });
          }, 1500);
        } else {
          // æ˜¾ç¤ºé”™è¯¯
          this.handleLoginError(code, message);
        }
      } catch (e) {
        console.error('ç™»å½•å¤±è´¥:', e);
        uni.showToast({
          title: 'ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•',
          icon: 'none'
        });
      } finally {
        this.loading = false;
      }
    },
    
    handleLoginError(code, message) {
      let duration = 2000;
      
      switch (code) {
        case 40003:
          // è´¦å·æˆ–å¯†ç é”™è¯¯
          this.password = '';
          break;
        case 40004:
          // è´¦å·è¢«ç¦ç”¨
          duration = 3000;
          break;
      }
      
      uni.showToast({
        title: message,
        icon: 'none',
        duration: duration
      });
    }
  }
};
</script>
```

## ğŸ” é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

### 1. å‰ç«¯å¤„ç†å»ºè®®

âœ… **æ¨èåšæ³•**ï¼š

- æ ¹æ®`code`å­—æ®µåˆ¤æ–­ä¸šåŠ¡é€»è¾‘ç»“æœï¼ˆ`code === 200`è¡¨ç¤ºæˆåŠŸï¼‰
- æ˜¾ç¤ºåç«¯è¿”å›çš„`message`å­—æ®µç»™ç”¨æˆ·
- å¯¹ä¸åŒé”™è¯¯ç è¿›è¡Œå·®å¼‚åŒ–å¤„ç†
- ç½‘ç»œå¼‚å¸¸æ—¶ç»™äºˆå‹å¥½æç¤º
- æ•æ„Ÿæ“ä½œå¤±è´¥åæ¸…ç©ºå¯†ç è¾“å…¥æ¡†

âŒ **ä¸æ¨èåšæ³•**ï¼š

- ä¾èµ–HTTPçŠ¶æ€ç åˆ¤æ–­ä¸šåŠ¡ç»“æœï¼ˆæ‰€æœ‰ä¸šåŠ¡é”™è¯¯éƒ½è¿”å›200ï¼‰
- è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯è¦†ç›–åç«¯è¿”å›çš„message
- å¿½ç•¥é”™è¯¯ç ï¼Œåªæ˜¾ç¤ºç»Ÿä¸€çš„"ç™»å½•å¤±è´¥"

### 2. é”™è¯¯æç¤ºç¤ºä¾‹

| åœºæ™¯ | æ¨èæç¤ºæ–¹å¼ |
|------|-------------|
| è´¦å·æˆ–å¯†ç é”™è¯¯ | Toast/Messageæç¤ºï¼Œæ¸…ç©ºå¯†ç æ¡† |
| è´¦å·è¢«ç¦ç”¨ | Modalå¯¹è¯æ¡†ï¼Œæä¾›å®¢æœè”ç³»æ–¹å¼ |
| å‚æ•°æ ¡éªŒå¤±è´¥ | è¡¨å•éªŒè¯æç¤ºï¼Œæ ‡çº¢é”™è¯¯å­—æ®µ |
| ç³»ç»Ÿå¼‚å¸¸ | Toastæç¤ºï¼Œå¼•å¯¼ç”¨æˆ·ç¨åé‡è¯• |

### 3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

```javascript
// ç™»å½•å¤±è´¥åçš„ä¼˜åŒ–å¤„ç†
function handleLoginFailure(code, message) {
  switch (code) {
    case 40003:
      // è´¦å·æˆ–å¯†ç é”™è¯¯ - æ¸…ç©ºå¯†ç ï¼Œèšç„¦åˆ°å¯†ç è¾“å…¥æ¡†
      form.password = '';
      passwordInput.focus();
      showError(message);
      break;
      
    case 40004:
      // è´¦å·è¢«ç¦ç”¨ - æ˜¾ç¤ºè¯¦ç»†è¯´æ˜å’Œè”ç³»æ–¹å¼
      showModal({
        title: 'è´¦å·å·²è¢«ç¦ç”¨',
        content: message + '\n\nå¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»ï¼š\nå®¢æœç”µè¯ï¼š400-xxx-xxxx\nå®¢æœé‚®ç®±ï¼šsupport@unisport.com',
        showCancel: false
      });
      break;
      
    case 50000:
      // ç³»ç»Ÿå¼‚å¸¸ - è®°å½•é”™è¯¯ï¼Œæ˜¾ç¤ºå‹å¥½æç¤º
      logError('login_system_error', { message });
      showError(message);
      break;
      
    default:
      showError(message || 'ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
  }
}
```

## ğŸ” å®‰å…¨æ€§è¯´æ˜

### 1. é”™è¯¯ä¿¡æ¯è„±æ•

ä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œè´¦å·ä¸å­˜åœ¨å’Œå¯†ç é”™è¯¯ä½¿ç”¨ç›¸åŒçš„æç¤ºä¿¡æ¯ï¼š

```
"è´¦å·æˆ–å¯†ç é”™è¯¯ï¼Œè¯·æ£€æŸ¥åé‡è¯•"
```

è¿™æ ·å¯ä»¥é˜²æ­¢æ¶æ„ç”¨æˆ·é€šè¿‡ä¸åŒçš„é”™è¯¯æç¤ºåˆ¤æ–­è´¦å·æ˜¯å¦å­˜åœ¨ã€‚

### 2. æ—¥å¿—è®°å½•

åç«¯ä¼šè®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ç”¨äºé—®é¢˜æ’æŸ¥ï¼š

```
// è´¦å·ä¸å­˜åœ¨
log.warn("ç™»å½•å¤±è´¥ï¼šè´¦å·ä¸å­˜åœ¨ï¼Œè´¦å·ï¼š{}", account);

// å¯†ç é”™è¯¯
log.warn("ç™»å½•å¤±è´¥ï¼šå¯†ç é”™è¯¯ï¼Œè´¦å·ï¼š{}", account);

// è´¦å·è¢«ç¦ç”¨
log.warn("ç™»å½•å¤±è´¥ï¼šè´¦å·å·²è¢«ç¦ç”¨ï¼Œè´¦å·ï¼š{}ï¼ŒçŠ¶æ€ï¼š{}", account, status);
```

ä½†è¿™äº›è¯¦ç»†ä¿¡æ¯ä¸ä¼šè¿”å›ç»™å‰ç«¯ã€‚

## ğŸ“ æµ‹è¯•ç”¨ä¾‹

### ä½¿ç”¨cURLæµ‹è¯•

```bash
# 1. æ­£å¸¸ç™»å½•
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"account":"2024001","password":"123456"}'

# 2. è´¦å·ä¸å­˜åœ¨
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"account":"notexist","password":"123456"}'

# 3. å¯†ç é”™è¯¯
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"account":"2024001","password":"wrongpwd"}'

# 4. è´¦å·ä¸ºç©º
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"account":"","password":"123456"}'

# 5. å¯†ç ä¸ºç©º
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"account":"2024001","password":""}'
```

## ğŸ“Š æ€»ç»“

### é”™è¯¯å¤„ç†æµç¨‹

1. **å‚æ•°æ ¡éªŒå±‚**ï¼š`@Valid`æ³¨è§£è‡ªåŠ¨æ ¡éªŒï¼Œå¤±è´¥æŠ›å‡º`MethodArgumentNotValidException`
2. **ä¸šåŠ¡é€»è¾‘å±‚**ï¼šServiceå±‚æ‰§è¡Œä¸šåŠ¡æ£€æŸ¥ï¼Œå¤±è´¥æŠ›å‡º`BusinessException`
3. **å…¨å±€å¼‚å¸¸å¤„ç†**ï¼š`GlobalExceptionHandler`ç»Ÿä¸€æ•è·å¹¶è½¬æ¢ä¸º`Result`æ ¼å¼
4. **å‰ç«¯æ¥æ”¶å¤„ç†**ï¼šå‰ç«¯æ ¹æ®`code`å’Œ`message`è¿›è¡Œç›¸åº”çš„UIå±•ç¤º

### å…³é”®è¦ç‚¹

âœ… æ‰€æœ‰é”™è¯¯éƒ½é€šè¿‡HTTP 200è¿”å›ï¼Œä¸šåŠ¡çŠ¶æ€é€šè¿‡`code`å­—æ®µåˆ¤æ–­  
âœ… é”™è¯¯æ¶ˆæ¯å‹å¥½ä¸”å…·æœ‰æŒ‡å¯¼æ€§  
âœ… å®‰å…¨æ€§ä¸ç”¨æˆ·ä½“éªŒå¹³è¡¡  
âœ… å‰ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨åç«¯è¿”å›çš„`message`è¿›è¡Œå±•ç¤º  
âœ… æ”¯æŒå¤šç§å‰ç«¯æ¡†æ¶å’ŒæŠ€æœ¯æ ˆ  

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2025-12-04  
**ç»´æŠ¤äººå‘˜**ï¼šUniSport Team
